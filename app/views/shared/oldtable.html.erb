<table class="table">
  <tr colspan="3">
    <th>Product</th>
    <th class='center'>Ingredients</th>
    <th class='center' colspan="3">Actions</th>
  </tr>
  <% obj.each do |item| %>
    <% item_reactions = Reaction.where("product_id = ?", item.id) %>
    <!-- for debugging... < % x=1/0 % >  -->
          <tr>
    <% if item_reactions.empty? %>

        <td class="text-color-ok"><%= item.name %></td>
        <td class="text-color-ok"><%= item.ingredients %></td>
    <% else %>
      <!-- <tr id='background-not-ok'> -->
        <td class="text-color-not-ok"><%= item.name %></td>
        <% allergic_ingredients = item_reactions.select(:reactive_ingredient).distinct.pluck(:reactive_ingredient).join(', ') %>
        <td class="text-color-not-ok"><%= item.ingredients %><strong class='color-not-ok mark'> Contains: <%=allergic_ingredients%></strong></td>
    <% end %>
      <td><%= link_to 'Edit', edit_product_path(item) %></td>
      <td><%= link_to 'Show', product_path(item) %></td>
      <td><%= link_to 'Delete', product_path(item), method: :delete, data: {confirm: "Are you sure?"} %></td>
    </tr>
  <% end %>
</table>